<%- include("../partials/head") %>

<nav class="navbar navbar-expand-lg bg-body-tertiary">
  <div class="container">
    <a class="navbar-brand brand-accent" href="/">KMITL NEW</a>
    <div class="navbar-nav">
      <a class="nav-link" href="/user/rumours">ผู้ใช้ทั่วไป</a>
      <a class="nav-link" href="/reviewer">ผู้ตรวจสอบ</a>
      <a class="nav-link active" href="/summary">สรุปผล</a>
    </div>
    <div class="navbar-nav ms-auto">
      <% if (currentUser) { %>
        <span class="navbar-text me-3">
          <%= currentUser.name %> (<%= currentUser.role === 'reviewer' ? 'ผู้ตรวจสอบ' : 'ผู้ใช้ทั่วไป' %>)
        </span>
        <form method="post" action="/logout" class="d-inline">
          <button class="btn btn-sm btn-outline-secondary" type="submit">ออกจากระบบ</button>
        </form>
      <% } else { %>
        <a class="nav-link" href="/login">เข้าสู่ระบบ</a>
      <% } %>
    </div>
  </div>
</nav>

<main class="container py-4">
  <h1 class="mb-4">หน้าสรุปผล</h1>

  <div class="row g-4">
    <div class="col-lg-6">
      <div class="card h-100">
        <div class="card-body">
          <h5 class="card-title">ข่าวลือที่เข้าสู่สถานะ panic</h5>
          <ul class="list-group list-group-flush">
            <% if (panicRumours.length === 0) { %>
              <li class="list-group-item">ไม่มีข่าวลือสถานะ panic</li>
            <% } %>
            <% panicRumours.forEach(r => { %>
              <li class="list-group-item">
                <strong><%= r.title %></strong>
                <div class="text-muted small">รหัส: <%= r.id %> | รายงาน: <%= r.report_count || 0 %></div>
              </li>
            <% }) %>
          </ul>
        </div>
      </div>
    </div>

    <div class="col-lg-6">
      <div class="card h-100">
        <div class="card-body">
          <h5 class="card-title">ผลตรวจสอบ (จริง/เท็จ)</h5>
          <ul class="list-group list-group-flush">
            <% if (verifiedRumours.length === 0) { %>
              <li class="list-group-item">ยังไม่มีข่าวลือที่ถูกยืนยัน</li>
            <% } %>
            <% verifiedRumours.forEach(r => { %>
              <li class="list-group-item">
                <strong><%= r.title %></strong>
                <span class="badge <%= r.verified_status === 'true' ? 'bg-success' : 'bg-danger' %>">
                  <%= r.verified_status %>
                </span>
                <div class="text-muted small">รหัส: <%= r.id %> | รายงาน: <%= r.report_count || 0 %></div>
              </li>
            <% }) %>
          </ul>
        </div>
      </div>
    </div>
  </div>
</main>

<%- include("../partials/foot") %>
